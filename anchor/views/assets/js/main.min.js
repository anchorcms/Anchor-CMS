"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};$(document).ready(function(){var e,t=0,n=function(){$("form").first().trigger("submit")};$(".autosave-action").click(function(){null===e?e=setInterval(function(){++t>30&&(t=0,n()),$(".autosave-label").text("Autosave in "+(30-t))},1e3):(clearInterval(e),e=null,t=0),function(){var t=null!==e;$(".autosave-action").toggleClass("green",t),$(".autosave-action").toggleClass("autosave-on",t),$(".autosave-action").toggleClass("secondary",!t),$(".autosave-label").text(t?"Autosave in 30":"Autosave: Off")}()})}),function(e){e.fn.changeSaver=function(){var t=e(this),n=!1,r=[],i=arguments[0]||"input[type=text], textarea";t.find(i).forEach(function(t,n){r.push({element:t,original_value:e(t).val()})}),e(t).on("submit",function(){n=!0}),e(window).on("beforeunload",function(){if(!n&&function(){for(var t=0;t<r.length;t++){var n=r[t];if(n.original_value!=e(n.element).val())return!0}return!1}())return"There are unsaved changes"})}}(Zepto),$(function(){var e=$("#label-field"),t=$(".hide"),n=$("#label-type"),r=$("#pagetype"),i=function(){var n=e.val();t.hide(),"image"==n?t.show():"file"==n&&$(".attributes_type").show()};e.bind("change",i);n.bind("change",function(){"page"==n.val()?r.parent().show():(r.parent().hide(),r.val("all"))}),i()}),$(function(){var e=$(document),t=$("body"),n=$('<div id="upload-file"><span>Upload your file</span></div>'),r=["text/css","text/javascript","application/javascript","text/x-markdown","application/pdf","image/jpeg","image/gif","image/png","image/bmp"],i=function(e){window.console&&console.log(e)},o=function(e){return n.hide().removeClass("active"),e.preventDefault(),!1},a=function(e){var t=new FileReader;t.file=e,t.callback=s,t.onload=t.callback,t.readAsBinaryString(e)},s=function(){if(-1!==["text/x-markdown"].indexOf(this.file.type)){(e=$(".main textarea")).val(this.result).trigger("keydown")}if(-1!==["text/javascript","application/javascript"].indexOf(this.file.type)){(e=$("textarea[name=js]")).val(this.result)}if(-1!==["text/css"].indexOf(this.file.type)){var e=$("textarea[name=css]");e.val(this.result)}if(-1!==["image/jpeg","image/gif","image/png","image/bmp","application/pdf"].indexOf(this.file.type)){var t,n=window.location.pathname,r=n.split("/");t="add"==r[r.length-1]?n.split("/").slice(0,-2).join("/")+"/upload":n.split("/").slice(0,-3).join("/")+"/upload",u(t,this.file)}},u=function(e,t){var n=new XMLHttpRequest;n.open("post",e);var r=new FormData;r.append("file",t),n.onreadystatechange=function(){if(4==this.readyState)return f(t,this.responseText)},n.upload?n.upload.onprogress=function(e){c(e.position||e.loaded,e.totalSize||e.total)}:n.addEventListener("progress",function(e){c(e.position||e.loaded,e.totalSize||e.total)},!1),n.send(r)},c=function(e,t){e==t?$("#upload-file-progress").hide():($("#upload-file-progress").show(),$("#upload-file-progress progress").prop("value",e),$("#upload-file-progress progress").prop("max",t))},f=function(e,t){var n=JSON.parse(t);if(n.uri){var r=$(".main textarea"),i=r[0],o=i.selectionStart,a=i.value,s="["+e.name+"]("+n.uri+")\n\n";s=-1!==["image/jpeg","image/gif","image/png","image/bmp"].indexOf(e.type)?"\n\n!"+s:"\n\n"+s,i.value=a.substring(0,o)+s+a.substring(o),i.selectionStart=i.selectionEnd=o+e.length,r.trigger("keydown")}};window.FileReader&&window.FileList&&window.File&&(e.on("dragover",function(e){return e.preventDefault(),n.show().addClass("active"),!1}),e.on("dragenter",o),e.on("drop",function(e){e.preventDefault();for(var t=e.target.files||e.dataTransfer.files,o=0;o<t.length;o++){var s=t.item(o);-1!==r.indexOf(s.type)?a(s):i(s.type+" not supported")}return n.hide().removeClass("active"),!1}),e.on("dragleave",o),e.on("dragexit",function(e){return e.preventDefault(),n.hide().removeClass("active"),!1}),t.append(n),t.append('<div id="upload-file-progress"><progress value="0"></progress></div>'))}),function(e){e.fn.editor=function(){var t=arguments[1]||{},n=(e.extend({},{},t),e(this)),r=n.parent(),i=function(e,t){var r=n[0],i=r.selectionStart,o=r.selectionEnd,a=r.value;r.value=a.substring(0,i)+e+a.substring(i,o)+t+a.substring(o),r.selectionStart=o+e.length+t.length},o={bold:function(){i("**","**")},italic:function(){i("*","*")},code:function(){var e="`",t=n[0],r=t.selectionStart,o=t.selectionEnd,a=t.value.substring(r,o);/\n+.*/gm.test(a)&&(e="\n```\n"),i(e,e)},link:function(){var e=n[0],t=e.selectionStart,r=e.selectionEnd,i=e.value,o=i.substring(t,r),a="["+o+"]("+o+")";e.value=i.substring(0,t)+a+i.substring(r),e.selectionStart=e.selectionEnd=r+a.length},list:function(){for(var e=n[0],t=e.selectionStart,r=e.selectionEnd,i=e.value,o=i.substring(t,r).split("\n"),a=0;a<o.length;a++)o[a]="* "+o[a];e.value=i.substring(0,t)+"\n"+o.join("\n")+"\n"+i.substring(r)},quote:function(){for(var e=n[0],t=e.selectionStart,r=e.selectionEnd,i=e.value,o=i.substring(t,r).split("\n"),a=0;a<o.length;a++)o[a]="> "+o[a];e.value=i.substring(0,t)+o.join("\n")+i.substring(r)}};n.on("keydown",function(e){9===e.keyCode&&(e.preventDefault(),e.stopPropagation(),e.shiftKey&&9===e.keyCode?function(e){var t=n[0],r=t.selectionStart,i=t.selectionEnd,o=t.value,a=new RegExp(/^[\t]{1}/),s=0;if(r==i){for(;r>0;){if("\n"==o.charAt(r)){r++;break}r--}var u=o.substring(r,i);u.match(a)&&(t.value=o.substring(0,r)+u.replace(a,"")+o.substring(i),i--),t.selectionStart=t.selectionEnd=i}else{for(var c=o.substring(r,i).split("\n"),f=0;f<c.length;f++)c[f].match(a)&&(s++,c[f]=c[f].replace(a,""));t.value=o.substring(0,r)+c.join("\n")+o.substring(i),t.selectionStart=r,t.selectionEnd=i-s}}():function(e){for(var t=n[0],r=t.selectionStart,i=t.selectionEnd,o=t.value,a=o.substring(r,i).split("\n"),s=0;s<a.length;s++)a[s]="\t"+a[s];t.value=o.substring(0,r)+a.join("\n")+o.substring(i),i>r?(t.selectionStart=r,t.selectionEnd=i+a.length):t.selectionStart=t.selectionEnd=r+1}())}),r.on("click","nav a",function(t){var n=e(t.target).attr("href").split("#").pop();return o[n]&&o[n](),!1})}}(Zepto),function(e){var t=e(document),n=e("form").first(),r=n.find("button[type=submit]"),i=r.html(),o=r.data("loading"),a=(e(".top nav .active a"),e(".header .wrap")),s=e(".notifications"),u=document.title;t.on("keydown",function(e){if(e.ctrlKey&&83==e.keyCode&&!e.altKey)return n.trigger("submit"),!1}),n.on("submit",function(){var t={};e.each(e(this).serializeArray(),function(e,n){t[n.name]=n.value});var c=e(".autosave-action").hasClass("autosave-on");return t.autosave=c,r.prop("disabled",!0).css("cursor","wait").html(o),o&&(document.title=o),e.ajax({url:n.attr("action"),type:"POST",data:t,success:function(t,n,o){if((t=JSON.parse(t)).notification){document.title=t.notification;c=e('<p class="success">'+t.notification+"</p>");s.append(c),setTimeout(function(){c.animate({opacity:0},600,"ease-out",function(){e(this).remove()})},3e3)}else if(t.errors)for(index in t.errors){var a=t.errors[index],c=e('<p class="error">'+a+"</p>");s.append(c),setTimeout(function(){c.animate({opacity:0},600,"ease-out",function(){e(this).remove()})},3e3)}t.redirect&&t.redirect!=window.location.href?setTimeout(function(){window.location.href=t.redirect},1e3):setTimeout(function(){document.title=u},3e3),r.prop("disabled",!1).html(i).removeAttr("style")},error:function(t,n,o){var s=e('<div class="notifications"><p class="error">Error</p></div>');a.prepend(s),setTimeout(function(){s.animate({opacity:0},600,"ease-out",function(){e(this).remove()}),document.title=u},3e3),r.prop("disabled",!1).html(i).removeAttr("style")}}),!1})}(Zepto),$(function(){var e=$(document),t=$("html"),n=t.children("body"),r={target:$("textarea[name=html], textarea[name=content]"),exitSpan:"#exit-focus",enter:function(){t.addClass("focus"),n.children(r.exitSpan).length||n.append('<span class="btn" id="'+r.exitSpan.substr(1)+'">Exit focus mode (ESC)</span>'),n.children(r.exitSpan).css("opacity",0).animate({opacity:1},250),r.target.placeholder=(r.target.placeholder||"").split(".")[0]+"."},exit:function(){n.children(r.exitSpan).animate({opacity:0},250),t.removeClass("focus")}};r.target.focus(r.enter).blur(r.exit),e.on("keyup",function(e){70==e.keyCode&&r.enter(),27==e.keyCode&&r.exit()})}),$(function(e,t){var e=$("input[name=title]"),n=!1;(t=$("input[name=name]")).bind("keyup",function(){n=!0}),e.bind("keyup",function(){n||t.val(e.val())})}),$(function(){var e=$("fieldset.redirect"),t=$("input[name=redirect]");$("button.secondary.redirector").bind("click",function(){return e.toggleClass("show"),e.hasClass("show")?t.removeAttr("tabindex"):t.attr("tabindex","-1"),!1}),t.change(function(){""===t.val()&&e.removeClass("show")}),""!==t.val()&&e.addClass("show"),t.hasClass("show")||t.attr("tabindex",-1)}),$(function(){var e=$("input[name=title]"),t=$("input[name=slug]"),n=t.val(),r=!1,i=function(e){var t;e=String(e);t={"©":"(c)","Á":"A","á":"a","À":"A","à":"a","Â":"A","â":"a","Å":"A","å":"a","Ä":"Ae","ä":"ae","Ã":"A","ã":"a","Ą":"A","ą":"a","Ā":"A","ā":"a","Æ":"AE","æ":"ae","Ć":"C","ć":"c","Č":"C","č":"c","Ç":"C","ç":"c","Ď":"D","ď":"d","Ð":"D","ð":"d","É":"E","é":"e","È":"E","è":"e","Ê":"E","ê":"e","Ě":"E","ě":"e","Ë":"E","ë":"e","Ę":"e","ę":"e","Ē":"E","ē":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Í":"I","í":"i","Ì":"I","ì":"i","Î":"I","î":"i","Ï":"I","ï":"i","İ":"I","Ī":"i","ī":"i","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ň":"N","ň":"n","Ñ":"N","ñ":"n","Ņ":"N","ņ":"n","Ó":"O"},_defineProperty(t,"Ó","o"),_defineProperty(t,"ó","o"),_defineProperty(t,"Ò","O"),_defineProperty(t,"ò","o"),_defineProperty(t,"Ô","O"),_defineProperty(t,"ô","o"),_defineProperty(t,"Ö","Oe"),_defineProperty(t,"ö","oe"),_defineProperty(t,"Ő","O"),_defineProperty(t,"ő","o"),_defineProperty(t,"Õ","O"),_defineProperty(t,"õ","o"),_defineProperty(t,"Ø","O"),_defineProperty(t,"ø","o"),_defineProperty(t,"Ř","R"),_defineProperty(t,"ř","r"),_defineProperty(t,"Ś","S"),_defineProperty(t,"ś","s"),_defineProperty(t,"Š","S"),_defineProperty(t,"š","s"),_defineProperty(t,"Ş","S"),_defineProperty(t,"ş","s"),_defineProperty(t,"ß","ss"),_defineProperty(t,"Ť","T"),_defineProperty(t,"ť","t"),_defineProperty(t,"Ú","U"),_defineProperty(t,"ú","u"),_defineProperty(t,"Ù","U"),_defineProperty(t,"ù","u"),_defineProperty(t,"Û","U"),_defineProperty(t,"û","u"),_defineProperty(t,"Ů","U"),_defineProperty(t,"ů","u"),_defineProperty(t,"Ü","Ue"),_defineProperty(t,"ü","ue"),_defineProperty(t,"Ű","U"),_defineProperty(t,"ű","u"),_defineProperty(t,"Ū","u"),_defineProperty(t,"ū","u"),_defineProperty(t,"Ý","Y"),_defineProperty(t,"ý","y"),_defineProperty(t,"ÿ","y"),_defineProperty(t,"Ź","Z"),_defineProperty(t,"ź","z"),_defineProperty(t,"Ž","Z"),_defineProperty(t,"ž","z"),_defineProperty(t,"Ż","Z"),_defineProperty(t,"ż","z"),_defineProperty(t,"Þ","TH"),_defineProperty(t,"þ","th"),_defineProperty(t,"Α","A"),_defineProperty(t,"α","a"),_defineProperty(t,"Ά","A"),_defineProperty(t,"ά","a"),_defineProperty(t,"Β","B"),_defineProperty(t,"β","b"),_defineProperty(t,"Γ","G"),_defineProperty(t,"γ","g"),_defineProperty(t,"Δ","D"),_defineProperty(t,"δ","d"),_defineProperty(t,"Ε","E"),_defineProperty(t,"ε","e"),_defineProperty(t,"Έ","E"),_defineProperty(t,"έ","e"),_defineProperty(t,"Ζ","Z"),_defineProperty(t,"ζ","z"),_defineProperty(t,"Η","H"),_defineProperty(t,"η","h"),_defineProperty(t,"Ή","H"),_defineProperty(t,"ή","h"),_defineProperty(t,"Θ","8"),_defineProperty(t,"θ","8"),_defineProperty(t,"Ι","I"),_defineProperty(t,"ι","i"),_defineProperty(t,"Ί","I"),_defineProperty(t,"ί","i"),_defineProperty(t,"Ϊ","I"),_defineProperty(t,"ϊ","i"),_defineProperty(t,"ΐ","i"),_defineProperty(t,"Κ","K"),_defineProperty(t,"κ","k"),_defineProperty(t,"Λ","L"),_defineProperty(t,"λ","l"),_defineProperty(t,"Μ","M"),_defineProperty(t,"μ","m"),_defineProperty(t,"Ν","N"),_defineProperty(t,"ν","n"),_defineProperty(t,"Ξ","3"),_defineProperty(t,"ξ","3"),_defineProperty(t,"Ο","O"),_defineProperty(t,"ο","o"),_defineProperty(t,"Ό","O"),_defineProperty(t,"ό","o"),_defineProperty(t,"Π","P"),_defineProperty(t,"π","p"),_defineProperty(t,"Ρ","R"),_defineProperty(t,"ρ","r"),_defineProperty(t,"Σ","S"),_defineProperty(t,"ς","s"),_defineProperty(t,"σ","s"),_defineProperty(t,"Τ","T"),_defineProperty(t,"τ","t"),_defineProperty(t,"Υ","Y"),_defineProperty(t,"υ","y"),_defineProperty(t,"Ύ","Y"),_defineProperty(t,"ύ","y"),_defineProperty(t,"Ϋ","Y"),_defineProperty(t,"ϋ","y"),_defineProperty(t,"ΰ","y"),_defineProperty(t,"Φ","F"),_defineProperty(t,"φ","f"),_defineProperty(t,"Χ","X"),_defineProperty(t,"χ","x"),_defineProperty(t,"Ψ","PS"),_defineProperty(t,"ψ","ps"),_defineProperty(t,"Ω","W"),_defineProperty(t,"ω","w"),_defineProperty(t,"Ώ","W"),_defineProperty(t,"ώ","w"),_defineProperty(t,"А","A"),_defineProperty(t,"а","a"),_defineProperty(t,"Б","B"),_defineProperty(t,"б","b"),_defineProperty(t,"В","V"),_defineProperty(t,"в","v"),_defineProperty(t,"Г","G"),_defineProperty(t,"г","g"),_defineProperty(t,"Ґ","G"),_defineProperty(t,"Д","D"),_defineProperty(t,"д","d"),_defineProperty(t,"Е","E"),_defineProperty(t,"е","e"),_defineProperty(t,"Ё","Yo"),_defineProperty(t,"ё","yo"),_defineProperty(t,"Є","Ye"),_defineProperty(t,"є","ye"),_defineProperty(t,"Ж","Zh"),_defineProperty(t,"ж","zh"),_defineProperty(t,"З","Z"),_defineProperty(t,"з","z"),_defineProperty(t,"И","I"),_defineProperty(t,"и","i"),_defineProperty(t,"І","I"),_defineProperty(t,"і","i"),_defineProperty(t,"Ї","Yi"),_defineProperty(t,"ї","yi"),_defineProperty(t,"Й","J"),_defineProperty(t,"й","j"),_defineProperty(t,"К","K"),_defineProperty(t,"к","k"),_defineProperty(t,"Л","L"),_defineProperty(t,"л","l"),_defineProperty(t,"М","M"),_defineProperty(t,"м","m"),_defineProperty(t,"Н","N"),_defineProperty(t,"н","n"),_defineProperty(t,"О","O"),_defineProperty(t,"о","o"),_defineProperty(t,"П","P"),_defineProperty(t,"п","p"),_defineProperty(t,"Р","R"),_defineProperty(t,"р","r"),_defineProperty(t,"С","S"),_defineProperty(t,"с","s"),_defineProperty(t,"Т","T"),_defineProperty(t,"т","t"),_defineProperty(t,"У","U"),_defineProperty(t,"у","u"),_defineProperty(t,"Ф","F"),_defineProperty(t,"ф","f"),_defineProperty(t,"Х","H"),_defineProperty(t,"х","h"),_defineProperty(t,"Ц","C"),_defineProperty(t,"ц","c"),_defineProperty(t,"Ч","Ch"),_defineProperty(t,"ч","ch"),_defineProperty(t,"Ш","Sh"),_defineProperty(t,"ш","sh"),_defineProperty(t,"Щ","Sh"),_defineProperty(t,"щ","sh"),_defineProperty(t,"Ы","Y"),_defineProperty(t,"ы","y"),_defineProperty(t,"Э","E"),_defineProperty(t,"э","e"),_defineProperty(t,"Ю","Yu"),_defineProperty(t,"ю","yu"),_defineProperty(t,"Я","Ya"),_defineProperty(t,"я","ya");for(var n=["À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","Ø","Ù","Ú","Û","Ü","Ý","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ñ","ò","ó","ô","õ","ö","ø","ù","ú","û","ü","ý","ÿ","Ā","ā","Ă","ă","Ą","ą","Ć","ć","Ĉ","ĉ","Ċ","ċ","Č","č","Ď","ď","Đ","đ","Ē","ē","Ĕ","ĕ","Ė","ė","Ę","ę","Ě","ě","Ĝ","ĝ","Ğ","ğ","Ġ","ġ","Ģ","ģ","Ĥ","ĥ","Ħ","ħ","Ĩ","ĩ","Ī","ī","Ĭ","ĭ","Į","į","İ","ı","Ĳ","ĳ","Ĵ","ĵ","Ķ","ķ","Ĺ","ĺ","Ļ","ļ","Ľ","ľ","Ŀ","ŀ","Ł","ł","Ń","ń","Ņ","ņ","Ň","ň","ŉ","Ō","ō","Ŏ","ŏ","Ő","ő","Œ","œ","Ŕ","ŕ","Ŗ","ŗ","Ř","ř","Ś","ś","Ŝ","ŝ","Ş","ş","Š","š","Ţ","ţ","Ť","ť","Ŧ","ŧ","Ũ","ũ","Ū","ū","Ŭ","ŭ","Ů","ů","Ű","ű","Ų","ų","Ŵ","ŵ","Ŷ","ŷ","Ÿ","Ź","ź","Ż","ż","Ž","ž","ſ","ƒ","Ơ","ơ","Ư","ư","Ǎ","ǎ","Ǐ","ǐ","Ǒ","ǒ","Ǔ","ǔ","Ǖ","ǖ","Ǘ","ǘ","Ǚ","ǚ","Ǜ","ǜ","Ǻ","ǻ","Ǽ","ǽ","Ǿ","ǿ","·","/","_",",",":",";"],r=["A","A","A","A","A","A","AE","C","E","E","E","E","I","I","I","I","D","N","O","O","O","O","O","O","U","U","U","U","Y","s","a","a","a","a","a","a","ae","c","e","e","e","e","i","i","i","i","n","o","o","o","o","o","o","u","u","u","u","y","y","A","a","A","a","A","a","C","c","C","c","C","c","C","c","D","d","D","d","E","e","E","e","E","e","E","e","E","e","G","g","G","g","G","g","G","g","H","h","H","h","I","i","I","i","I","i","I","i","I","i","IJ","ij","J","j","K","k","L","l","L","l","L","l","L","l","l","l","N","n","N","n","N","n","n","O","o","O","o","O","o","OE","oe","R","r","R","r","R","r","S","s","S","s","S","s","S","s","T","t","T","t","T","t","U","u","U","u","U","u","U","u","U","u","U","u","W","w","Y","y","Y","Z","z","Z","z","Z","z","s","f","O","o","U","u","A","a","I","i","O","o","U","u","U","u","U","u","U","u","U","u","A","a","AE","ae","O","o","-","-","-","-","-","-"],i=0;i<n.length;i++)e=e.replace(new RegExp(n[i],"g"),r[i]);return e.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")};t.bind("focus",function(){r=t.val(),n=t.val()}),t.bind("blur",function(){""==t.val()?t.val(i(e.val())):t.val(i(t.val()))}),e.bind("keyup",function(){""==n&&t.val(i(e.val()))})}),function(e){e.fn.sortable=function(t){var n,r=e.extend({},{element:"li",dropped:function(){}},t),i=e(this).find(r.element);i.on("dragstart",function(t){e(this).addClass("moving"),n=this,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",this.innerHTML)}),i.on("dragenter",function(){e(this).addClass("over")}),i.on("dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move"}),i.on("dragleave",function(){e(this).removeClass("over")}),i.on("drop",function(e){e.preventDefault(),e.stopPropagation(),n!=this&&(n.innerHTML=this.innerHTML,this.innerHTML=e.dataTransfer.getData("text/html")),r.dropped()}),i.on("dragend",function(){e(this).removeClass("moving"),i.removeClass("over")})}}(Zepto),$(function(){function e(e){var n=window.pageYOffset;t.height(t.prop("scrollHeight")+"px"),window.scrollTo(0,n)}var t=$("textarea").first();t.on("change",e),t.on("cut paste drop keydown",function(t){window.setTimeout(function(){e()},0)}),t.focus(),t.select(),e()}),$(function(){if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)try{var e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}$("input[type=file]").bind("change",function(){var e=$(this);e.parent().parent().find(".current-file").html(function(e){return e.replace(/\\/g,"/").replace(/.*\//,"")}(e.val()));new FormData;for(var n=this.files,r=0;r<n.length;r++){var i=n[r];if(-1!==["image/jpeg","image/gif","image/png","image/bmp","application/pdf"].indexOf(i.type)){var o=window.location.pathname,a=o.split("/");if("add"==a[a.length-1])s=o.split("/").slice(0,-2).join("/")+"/upload";else var s=o.split("/").slice(0,-3).join("/")+"/upload";t(s,i,this)}}});var t=function(t,n,r){e.open("post",t);var i=new FormData;i.append("file",n),e.onreadystatechange=function(){if(4==this.readyState){console.log("Uploaded");var e=JSON.parse(this.responseText);console.log(e),$(r).parent().append('<input type="hidden" name="'+$(r).attr("name")+'" value="'+e.uri+'">')}},e.upload?e.upload.onprogress=function(e){console.log(e.position+":"+e.total)}:e.addEventListener("progress",function(e){console.log(e.position+":"+e.total)},!1),e.send(i)}}),function(e){String.prototype.trim===e&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===e&&(Array.prototype.reduce=function(t){if(void 0===this||null===this)throw new TypeError;var n,r=Object(this),i=r.length>>>0,o=0;if("function"!=typeof t)throw new TypeError;if(0==i&&1==arguments.length)throw new TypeError;if(arguments.length>=2)n=arguments[1];else for(;;){if(o in r){n=r[o++];break}if(++o>=i)throw new TypeError}for(;o<i;)o in r&&(n=t.call(e,n,r[o],o,r)),o++;return n})}();var Zepto=function(){function e(e){return"[object Function]"==L.call(e)}function t(e){return e instanceof Object}function n(t){var n,r;if("[object Object]"!==L.call(t))return!1;if(!(r=e(t.constructor)&&t.constructor.prototype)||!hasOwnProperty.call(r,"isPrototypeOf"))return!1;for(n in t);return n===p||hasOwnProperty.call(t,n)}function r(e){return e instanceof Array}function i(e){return"number"==typeof e.length}function o(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function a(e){return e in w?w[e]:w[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function s(e,t){return"number"!=typeof t||E[o(e)]?t:t+"px"}function u(e,t){return t===p?h(e):h(e).filter(t)}function c(t,n,r,i){return e(n)?n.call(t,r,i):n}function f(e,t,n){var r=e%2?t:t.parentNode;r?r.insertBefore(n,e?1==e?r.firstChild:2==e?t:null:t.nextSibling):h(n).remove()}function l(e,t){t(e);for(var n in e.childNodes)l(e.childNodes[n],t)}var p,d,h,y,v,g,m=[],P=m.slice,_=window.document,b={},w={},x=_.defaultView.getComputedStyle,E={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},S=/^\s*<(\w+|!)[^>]*>/,T=[1,3,8,9,11],O=_.createElement("table"),C=_.createElement("tr"),j={tr:_.createElement("tbody"),tbody:O,thead:O,tfoot:O,td:C,th:C,"*":_.createElement("div")},$=/complete|loaded|interactive/,A=/^\.([\w-]+)$/,k=/^#([\w-]+)$/,N=/^[\w-]+$/,L={}.toString,U={},D=_.createElement("div");return U.matches=function(e,t){if(!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,o=!i;return o&&(i=D).appendChild(e),r=~U.qsa(i,t).indexOf(e),o&&D.removeChild(e),r},v=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},g=function(e){return e.filter(function(t,n){return e.indexOf(t)==n})},U.fragment=function(e,t){t===p&&(t=S.test(e)&&RegExp.$1),t in j||(t="*");var n=j[t];return n.innerHTML=""+e,h.each(P.call(n.childNodes),function(){n.removeChild(this)})},U.Z=function(e,t){return e=e||[],e.__proto__=arguments.callee.prototype,e.selector=t||"",e},U.isZ=function(e){return e instanceof U.Z},U.init=function(t,i){if(!t)return U.Z();if(e(t))return h(_).ready(t);if(U.isZ(t))return t;var o;if(r(t))o=function(e){return e.filter(function(e){return e!==p&&null!==e})}(t);else if(n(t))o=[h.extend({},t)],t=null;else if(T.indexOf(t.nodeType)>=0||t===window)o=[t],t=null;else if(S.test(t))o=U.fragment(t.trim(),RegExp.$1),t=null;else{if(i!==p)return h(i).find(t);o=U.qsa(_,t)}return U.Z(o,t)},h=function(e,t){return U.init(e,t)},h.extend=function(e){return P.call(arguments,1).forEach(function(t){for(d in t)t[d]!==p&&(e[d]=t[d])}),e},U.qsa=function(e,t){var n;return e===_&&k.test(t)?(n=e.getElementById(RegExp.$1))?[n]:m:1!==e.nodeType&&9!==e.nodeType?m:P.call(A.test(t)?e.getElementsByClassName(RegExp.$1):N.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},h.isFunction=e,h.isObject=t,h.isArray=r,h.isPlainObject=n,h.inArray=function(e,t,n){return m.indexOf.call(t,e,n)},h.trim=function(e){return e.trim()},h.uuid=0,h.map=function(e,t){var n,r,o,a=[];if(i(e))for(r=0;r<e.length;r++)null!=(n=t(e[r],r))&&a.push(n);else for(o in e)null!=(n=t(e[o],o))&&a.push(n);return function(e){return e.length>0?[].concat.apply([],e):e}(a)},h.each=function(e,t){var n,r;if(i(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(r in e)if(!1===t.call(e[r],r,e[r]))return e;return e},h.fn={forEach:m.forEach,reduce:m.reduce,push:m.push,indexOf:m.indexOf,concat:m.concat,map:function(e){return h.map(this,function(t,n){return e.call(t,n,t)})},slice:function(){return h(P.apply(this,arguments))},ready:function(e){return $.test(_.readyState)?e(h):_.addEventListener("DOMContentLoaded",function(){e(h)},!1),this},get:function(e){return e===p?P.call(this):this[e]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return this.forEach(function(t,n){e.call(t,n,t)}),this},filter:function(e){return h([].filter.call(this,function(t){return U.matches(t,e)}))},add:function(e,t){return h(g(this.concat(h(e,t))))},is:function(e){return this.length>0&&U.matches(this[0],e)},not:function(t){var n=[];if(e(t)&&t.call!==p)this.each(function(e){t.call(this,e)||n.push(this)});else{var r="string"==typeof t?this.filter(t):i(t)&&e(t.item)?P.call(t):h(t);this.forEach(function(e){r.indexOf(e)<0&&n.push(e)})}return h(n)},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!t(e)?e:h(e)},last:function(){var e=this[this.length-1];return e&&!t(e)?e:h(e)},find:function(e){var t;return t=1==this.length?U.qsa(this[0],e):this.map(function(){return U.qsa(this,e)}),h(t)},closest:function(e,t){for(var n=this[0];n&&!U.matches(n,e);)n=n!==t&&n!==_&&n.parentNode;return h(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=h.map(n,function(e){if((e=e.parentNode)&&e!==_&&t.indexOf(e)<0)return t.push(e),e});return u(t,e)},parent:function(e){return u(g(this.pluck("parentNode")),e)},children:function(e){return u(this.map(function(){return P.call(this.children)}),e)},siblings:function(e){return u(this.map(function(e,t){return P.call(t.parentNode.children).filter(function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return this.map(function(){return this[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==x(this,"").getPropertyValue("display")&&(this.style.display=function(e){var t,n;return b[e]||(t=_.createElement(e),_.body.appendChild(t),n=x(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),b[e]=n),b[e]}(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return this.each(function(){h(this).wrapAll(h(e)[0].cloneNode(!1))})},wrapAll:function(e){return this[0]&&(h(this[0]).before(e=h(e)),e.append(this)),this},unwrap:function(){return this.parent().each(function(){h(this).replaceWith(h(this).children())}),this},clone:function(){return h(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(e){return(e===p?"none"==this.css("display"):e)?this.show():this.hide()},prev:function(){return h(this.pluck("previousElementSibling"))},next:function(){return h(this.pluck("nextElementSibling"))},html:function(e){return e===p?this.length>0?this[0].innerHTML:null:this.each(function(t){var n=this.innerHTML;h(this).empty().append(c(this,e,t,n))})},text:function(e){return e===p?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e})},attr:function(e,n){var r;return"string"==typeof e&&n===p?0==this.length||1!==this[0].nodeType?p:"value"==e&&"INPUT"==this[0].nodeName?this.val():!(r=this[0].getAttribute(e))&&e in this[0]?this[0][e]:r:this.each(function(r){if(1===this.nodeType)if(t(e))for(d in e)this.setAttribute(d,e[d]);else this.setAttribute(e,c(this,n,r,this.getAttribute(e)))})},removeAttr:function(e){return this.each(function(){1===this.nodeType&&this.removeAttribute(e)})},prop:function(e,t){return t===p?this[0]?this[0][e]:p:this.each(function(n){this[e]=c(this,t,n,this[e])})},data:function(e,t){var n=this.attr("data-"+o(e),t);return null!==n?n:p},val:function(e){return e===p?this.length>0?this[0].value:p:this.each(function(t){this.value=c(this,e,t,this.value)})},offset:function(){if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}},css:function(e,t){if(t===p&&"string"==typeof e)return 0==this.length?p:this[0].style[v(e)]||x(this[0],"").getPropertyValue(e);var n="";for(d in e)"string"==typeof e[d]&&""==e[d]?this.each(function(){this.style.removeProperty(o(d))}):n+=o(d)+":"+s(d,e[d])+";";return"string"==typeof e&&(""==t?this.each(function(){this.style.removeProperty(o(e))}):n=o(e)+":"+s(e,t)),this.each(function(){this.style.cssText+=";"+n})},index:function(e){return e?this.indexOf(h(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!(this.length<1)&&a(e).test(this[0].className)},addClass:function(e){return this.each(function(t){y=[];var n=this.className;c(this,e,t,n).split(/\s+/g).forEach(function(e){h(this).hasClass(e)||y.push(e)},this),y.length&&(this.className+=(n?" ":"")+y.join(" "))})},removeClass:function(e){return this.each(function(t){if(e===p)return this.className="";y=this.className,c(this,e,t,y).split(/\s+/g).forEach(function(e){y=y.replace(a(e)," ")}),this.className=y.trim()})},toggleClass:function(e,t){return this.each(function(n){var r=c(this,e,n,this.className);(t===p?!h(this).hasClass(r):t)?h(this).addClass(r):h(this).removeClass(r)})}},["width","height"].forEach(function(e){h.fn[e]=function(t){var n,r=e.replace(/./,function(e){return e[0].toUpperCase()});return t===p?this[0]==window?window["inner"+r]:this[0]==_?_.documentElement["offset"+r]:(n=this.offset())&&n[e]:this.each(function(n){var r=h(this);r.css(e,c(this,t,n,r[e]()))})}}),["after","prepend","before","append"].forEach(function(e,n){h.fn[e]=function(){var e=h.map(arguments,function(e){return t(e)?e:U.fragment(e)});if(e.length<1)return this;var r=this.length,i=r>1,o=n<2;return this.each(function(t,a){for(var s=0;s<e.length;s++){var u=e[o?e.length-s-1:s];l(u,function(e){null!=e.nodeName&&"SCRIPT"===e.nodeName.toUpperCase()&&(!e.type||"text/javascript"===e.type)&&window.eval.call(window,e.innerHTML)}),i&&t<r-1&&(u=u.cloneNode(!0)),f(n,a,u)}})},h.fn[n%2?e+"To":"insert"+(n?"Before":"After")]=function(t){return h(t)[e](this),this}}),U.Z.prototype=h.fn,U.camelize=v,U.uniq=g,h.zepto=U,h}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function t(e){return e._zid||(e._zid=c++)}function n(e,n,i,o){if((n=r(n)).ns)var a=function(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}(n.ns);return(u[t(e)]||[]).filter(function(e){return e&&(!n.e||e.e==n.e)&&(!n.ns||a.test(e.ns))&&(!i||t(e.fn)===t(i))&&(!o||e.sel==o)})}function r(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(t,n,r){e.isObject(t)?e.each(t,r):t.split(/\s/).forEach(function(e){r(e,n)})}function o(n,o,a,s,c,f){f=!!f;var l=t(n),p=u[l]||(u[l]=[]);i(o,a,function(t,i){var o=c&&c(i,t),a=o||i,u=function(e){var t=a.apply(n,[e].concat(e.data));return!1===t&&e.preventDefault(),t},l=e.extend(r(t),{fn:i,proxy:u,sel:s,del:o,i:p.length});p.push(l),n.addEventListener(l.e,u,f)})}function a(e,r,o,a){var s=t(e);i(r||"",o,function(t,r){n(e,t,r,a).forEach(function(t){delete u[s][t.i],e.removeEventListener(t.e,t.proxy,!1)})})}function s(t){var n=e.extend({originalEvent:t},t);return e.each(d,function(e,r){n[e]=function(){return this[r]=l,t[e].apply(t,arguments)},n[r]=p}),n}e.zepto.qsa;var u={},c=1,f={};f.click=f.mousedown=f.mouseup=f.mousemove="MouseEvents",e.event={add:o,remove:a},e.proxy=function(n,r){if(e.isFunction(n)){var i=function(){return n.apply(r,arguments)};return i._zid=t(n),i}if("string"==typeof r)return e.proxy(n[r],n);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){o(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){a(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,r){o(this,e,t,null,function(e,t){return function(){var n=e.apply(r,arguments);return a(r,t,e),n}})})};var l=function(){return!0},p=function(){return!1},d={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,r){var i=!1;return"blur"!=n&&"focus"!=n||(e.iswebkit?n="blur"==n?"focusout":"focus"==n?"focusin":n:i=!0),this.each(function(a,u){o(u,n,r,t,function(n){return function(r){var i,o=e(r.target).closest(t,u).get(0);if(o)return i=e.extend(s(r),{currentTarget:o,liveFired:u}),n.apply(o,[i].concat([].slice.call(arguments,1)))}},i)})},e.fn.undelegate=function(e,t,n){return this.each(function(){a(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r){return void 0==n||e.isFunction(n)?this.bind(t,n):this.delegate(n,t,r)},e.fn.off=function(t,n,r){return void 0==n||e.isFunction(n)?this.unbind(t,n):this.undelegate(n,t,r)},e.fn.trigger=function(t,n){return"string"==typeof t&&(t=e.Event(t)),function(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,r){var i,o;return this.each(function(a,u){(i=s("string"==typeof t?e.Event(t):t)).data=r,i.target=u,e.each(n(u,t.type||t),function(e,t){if(o=t.proxy(i),i.isImmediatePropagationStopped())return!1})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){if(e)this.bind(t,e);else if(this.length)try{this.get(0)[t]()}catch(e){}return this}}),e.Event=function(e,t){var n=document.createEvent(f[e]||"Events"),r=!0;if(t)for(var i in t)"bubbles"==i?r=!!t[i]:n[i]=t[i];return n.initEvent(e,r,!0,null,null,null,null,null,null,null,null,null,null,null,null),n}}(Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),o=e.match(/(iPad).*OS\s([\d_]+)/),a=!o&&e.match(/(iPhone\sOS)\s([\d_]+)/),s=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),u=s&&e.match(/TouchPad/),c=e.match(/Kindle\/([\d.]+)/),f=e.match(/Silk\/([\d._]+)/),l=e.match(/(BlackBerry).*Version\/([\d.]+)/);(n.webkit=!!r)&&(n.version=r[1]),i&&(t.android=!0,t.version=i[2]),a&&(t.ios=t.iphone=!0,t.version=a[2].replace(/_/g,".")),o&&(t.ios=t.ipad=!0,t.version=o[2].replace(/_/g,".")),s&&(t.webos=!0,t.version=s[2]),u&&(t.touchpad=!0),l&&(t.blackberry=!0,t.version=l[2]),c&&(t.kindle=!0,t.version=c[1]),f&&(n.silk=!0,n.version=f[1]),!f&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0)}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function(e,t){function n(e){return e.toLowerCase()}function r(e){return i?i+e:n(e)}var i,o="",a=window.document.createElement("div"),s=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,u={};e.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(e,r){if(a.style[e+"TransitionProperty"]!==t)return o="-"+n(e)+"-",i=r,!1}),u[o+"transition-property"]=u[o+"transition-duration"]=u[o+"transition-timing-function"]=u[o+"animation-name"]=u[o+"animation-duration"]="",e.fx={off:i===t&&a.style.transitionProperty===t,cssPrefix:o,transitionEnd:r("TransitionEnd"),animationEnd:r("AnimationEnd")},e.fn.animate=function(t,n,r,i){return e.isObject(n)&&(r=n.easing,i=n.complete,n=n.duration),n&&(n/=1e3),this.anim(t,n,r,i)},e.fn.anim=function(n,r,i,a){var c,f,l,p={},d=this,h=e.fx.transitionEnd;if(r===t&&(r=.4),e.fx.off&&(r=0),"string"==typeof n)p[o+"animation-name"]=n,p[o+"animation-duration"]=r+"s",h=e.fx.animationEnd;else{for(f in n)s.test(f)?(c||(c=[]),c.push(f+"("+n[f]+")")):p[f]=n[f];c&&(p[o+"transform"]=c.join(" ")),!e.fx.off&&"object"==(void 0===n?"undefined":_typeof(n))&&(p[o+"transition-property"]=Object.keys(n).join(", "),p[o+"transition-duration"]=r+"s",p[o+"transition-timing-function"]=i||"linear")}return l=function(t){if(void 0!==t){if(t.target!==t.currentTarget)return;e(t.target).unbind(h,arguments.callee)}e(this).css(u),a&&a.call(this)},r>0&&this.bind(h,l),setTimeout(function(){d.css(p),r<=0&&setTimeout(function(){d.each(function(){l.call(this)})},0)},0),this},a=null}(Zepto),function(e){function t(t,n,r,i){if(t.global)return function(t,n,r){var i=e.Event(n);return e(t).trigger(i,r),!i.defaultPrevented}(n||d,r,i)}function n(e,n,r){var o=r.context,a="success";r.success.call(o,e,a,n),t(r,o,"ajaxSuccess",[n,r,e]),i(a,n,r)}function r(e,n,r,o){var a=o.context;o.error.call(a,r,n,e),t(o,a,"ajaxError",[r,o,e]),i(n,r,o)}function i(n,r,i){var o=i.context;i.complete.call(o,r,n),t(i,o,"ajaxComplete",[r,i]),function(n){n.global&&!--e.active&&t(n,null,"ajaxStop")}(i)}function o(){}function a(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function s(t){p(t.data)&&(t.data=e.param(t.data)),t.data&&(!t.type||"GET"==t.type.toUpperCase())&&(t.url=a(t.url,t.data))}function u(t,n,r,i){var o=e.isArray(n);e.each(n,function(n,a){i&&(n=r?i:i+"["+(o?"":n)+"]"),!i&&o?t.add(a.name,a.value):(r?e.isArray(a):p(a))?u(t,a,r,n):t.add(n,a)})}var c,f,l=0,p=e.isObject,d=window.document,h=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,y=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,g="application/json",m="text/html",P=/^\s*$/;e.active=0,e.ajaxJSONP=function(t){var r,a="jsonp"+ ++l,u=d.createElement("script"),c={abort:function(){e(u).remove(),a in window&&(window[a]=o),i("abort",c,t)}};return t.error&&(u.onerror=function(){c.abort(),t.error()}),window[a]=function(i){clearTimeout(r),e(u).remove(),delete window[a],n(i,c,t)},s(t),u.src=t.url.replace(/=\?/,"="+a),e("head").append(u),t.timeout>0&&(r=setTimeout(function(){c.abort(),i("timeout",c,t)},t.timeout)),c},e.ajaxSettings={type:"GET",beforeSend:o,success:o,error:o,complete:o,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:g,xml:"application/xml, text/xml",html:m,text:"text/plain"},crossDomain:!1,timeout:0},e.ajax=function(i){var u=e.extend({},i||{});for(c in e.ajaxSettings)void 0===u[c]&&(u[c]=e.ajaxSettings[c]);(function(n){n.global&&0==e.active++&&t(n,null,"ajaxStart")})(u),u.crossDomain||(u.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(u.url)&&RegExp.$2!=window.location.host);var l=u.dataType,p=/=\?/.test(u.url);if("jsonp"==l||p)return p||(u.url=a(u.url,"callback=?")),e.ajaxJSONP(u);u.url||(u.url=window.location.toString()),s(u);var d,h=u.accepts[l],_={},b=/^([\w-]+:)\/\//.test(u.url)?RegExp.$1:window.location.protocol,w=e.ajaxSettings.xhr();u.crossDomain||(_["X-Requested-With"]="XMLHttpRequest"),h&&(_.Accept=h,h.indexOf(",")>-1&&(h=h.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(h)),(u.contentType||u.data&&"GET"!=u.type.toUpperCase())&&(_["Content-Type"]=u.contentType||"application/x-www-form-urlencoded"),u.headers=e.extend(_,u.headers||{}),w.onreadystatechange=function(){if(4==w.readyState){clearTimeout(d);var e,t=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==b){l=l||function(e){return e&&(e==m?"html":e==g?"json":y.test(e)?"script":v.test(e)&&"xml")||"text"}(w.getResponseHeader("content-type")),e=w.responseText;try{"script"==l?(0,eval)(e):"xml"==l?e=w.responseXML:"json"==l&&(e=P.test(e)?null:JSON.parse(e))}catch(e){t=e}t?r(t,"parsererror",w,u):n(e,w,u)}else r(null,"error",w,u)}};var x=!("async"in u)||u.async;w.open(u.type,u.url,x);for(f in u.headers)w.setRequestHeader(f,u.headers[f]);return!1===function(e,n){var r=n.context;if(!1===n.beforeSend.call(r,e,n)||!1===t(n,r,"ajaxBeforeSend",[e,n]))return!1;t(n,r,"ajaxSend",[e,n])}(w,u)?(w.abort(),!1):(u.timeout>0&&(d=setTimeout(function(){w.onreadystatechange=o,w.abort(),r(null,"timeout",w,u)},u.timeout)),w.send(u.data?u.data:null),w)},e.get=function(t,n){return e.ajax({url:t,success:n})},e.post=function(t,n,r,i){return e.isFunction(n)&&(i=i||r,r=n,n=null),e.ajax({type:"POST",url:t,data:n,success:r,dataType:i})},e.getJSON=function(t,n){return e.ajax({url:t,success:n,dataType:"json"})},e.fn.load=function(t,n){if(!this.length)return this;var r,i=this,o=t.split(/\s/);return o.length>1&&(t=o[0],r=o[1]),e.get(t,function(t){i.html(r?e(d.createElement("div")).html(t.replace(h,"")).find(r).html():t),n&&n.call(i)}),this};var _=encodeURIComponent;e.param=function(e,t){var n=[];return n.add=function(e,t){this.push(_(e)+"="+_(t))},u(n,e,t),n.join("&").replace("%20","+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t,n=[];return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){var r=(t=e(this)).attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&("radio"!=r&&"checkbox"!=r||this.checked)&&n.push({name:t.attr("name"),value:t.val()})}),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e){function t(){i=null,o.last&&(o.el.trigger("longTap"),o={})}function n(){i&&clearTimeout(i),i=null}var r,i,o={};e(document).ready(function(){var a,s;e(document.body).bind("touchstart",function(n){a=Date.now(),s=a-(o.last||a),o.el=e(function(e){return"tagName"in e?e:e.parentNode}(n.touches[0].target)),r&&clearTimeout(r),o.x1=n.touches[0].pageX,o.y1=n.touches[0].pageY,s>0&&s<=250&&(o.isDoubleTap=!0),o.last=a,i=setTimeout(t,750)}).bind("touchmove",function(e){n(),o.x2=e.touches[0].pageX,o.y2=e.touches[0].pageY}).bind("touchend",function(e){n(),o.isDoubleTap?(o.el.trigger("doubleTap"),o={}):o.x2&&Math.abs(o.x1-o.x2)>30||o.y2&&Math.abs(o.y1-o.y2)>30?(o.el.trigger("swipe")&&o.el.trigger("swipe"+function(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}(o.x1,o.x2,o.y1,o.y2)),o={}):"last"in o&&(o.el.trigger("tap"),r=setTimeout(function(){r=null,o.el.trigger("singleTap"),o={}},250))}).bind("touchcancel",function(){r&&clearTimeout(r),i&&clearTimeout(i),i=r=null,o={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}})}(Zepto);